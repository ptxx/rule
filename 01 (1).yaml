# èŠ‚ç‚¹è®¢é˜…
proxy-providers:
  äºšé©¬é€Š:
    url: "https://www1st.ga-sub.lat/api/v1/client/subscribe?token=a60b97380db9163953ab7f11249e762f"
    type: http
    interval: 86400
    health-check:
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 180
    override:
      additional-prefix: "äºšé©¬é€Š"
    proxy: ç›´è¿
  èµšé’±:
    url: "https://dash.pqjc.site/api/v1/client/subscribe?token=b8be0157e153bbdf8f624e26647a3b1c"
    type: http
    interval: 86400
    health-check:
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 180
    override:
      additional-prefix: "èµšé’±"
    proxy: ç›´è¿
  ç‰›é€¼:
    url: "https://zhuzhuzhu.whtjdasha.com/api/v1/client/subscribe?token=ec132966eec3444fd21b1421a23df4e9"
    type: http
    interval: 86400
    health-check:
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 180
    override:
      additional-prefix: "ç‰›é€¼"
    proxy: ç›´è¿

proxies:
  - {name: ç›´è¿, type: direct, udp: true}
  - {name: æ‹’ç», type: reject}

# DNS è®¾ç½®
dns:
  enable: true
  listen: 0.0.0.0:7874
  ipv6: true
  respect-rules: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  proxy-server-nameserver:
    - 119.29.29.29
    - 223.5.5.5
  fake-ip-filter:
    - +.lan
    - +.local
    - geosite:cn

# TUN æ¨¡å—
tun:
  enable: true
  stack: mixed
  device: utun
  endpoint-independent-nat: true
  auto-route: true
  auto-detect-interface: true
  auto-redirect: true
  strict-route: false

profile:
  store-selected: true
  store-fake-ip: true

# é»˜è®¤ç­–ç•¥ç»„æ¨¡æ¿
default: &default
  type: select
  proxies:
    - â™»ï¸ ALL-æ™ºé€‰
    - ğŸŒ ALL-æ‰‹é€‰
    - ç›´è¿
    - æ‹’ç»    
    - é¦™æ¸¯-æ•…è½¬
    - é¦™æ¸¯-æ™ºé€‰
    - å°æ¹¾-æ•…è½¬
    - å°æ¹¾-æ™ºé€‰
    - ç¾å›½-æ•…è½¬
    - ç¾å›½-æ™ºé€‰
    - ç‹®åŸ-æ•…è½¬
    - ç‹®åŸ-æ™ºé€‰
    - æ—¥éŸ©-æ•…è½¬
    - æ—¥éŸ©-æ™ºé€‰
    
proxy-groups:
  - {name: ä¼˜å…ˆä»£ç†, <<: *default}
  - {name: æ¸¸æˆä»£ç†, <<: *default}
  - {name: YouTube, <<: *default}
  - {name: Google, <<: *default}
  - {name: Microsoft, <<: *default}  
  - {name: ChatGPT, <<: *default}
  - {name: GitHub, <<: *default}
  - {name: TikTok, <<: *default}
  - {name: Telegram, <<: *default}
  - {name: Netflix, <<: *default}
  - {name: SteamCN, <<: *default}  
  - {name: æ¼ç½‘ä¹‹é±¼, <<: *default}

  # å…¨å±€ç»„
  - name: ğŸŒ ALL-æ‰‹é€‰
    type: select
    include-all: true
    filter: "^((?!(ç›´è¿|æ‹’ç»|å‰©ä½™|åˆ°æœŸ|å»ºè®®æ¯æ¬¡|å¦‚æœåª|å¤ªæ—§|ä½¿ç”¨æ•™ç¨‹|ä¸€ä¸‹å®¢)).)*$"


  - name: â™»ï¸ ALL-æ™ºé€‰
    type: smart                      # æ™ºèƒ½ä»£ç†ç»„ç±»å‹ï¼ˆmihomo / clash.meta æ‰©å±•ï¼‰
    include-all: true
    filter: "^((?!(ç›´è¿|æ‹’ç»|å‰©ä½™|åˆ°æœŸ|å»ºè®®æ¯æ¬¡|å¦‚æœåª|å¤ªæ—§|ä½¿ç”¨æ•™ç¨‹|ä¸€ä¸‹å®¢)).)*$"
    interval: 300                    # æ¯300ç§’æµ‹é€Ÿä¸€æ¬¡ï¼ˆå»¶è¿Ÿ/å¯ç”¨æ€§ï¼‰
    timeout: 5000                    # è¶…æ—¶ä¸Šé™ 5000 æ¯«ç§’
    tolerance: 50                    # å»¶è¿Ÿå®¹å·®ï¼ˆæ¯«ç§’ï¼‰ï¼Œä½äºæ­¤å€¼ä¸ä¼šåˆ‡æ¢
    strategy: sticky-sessions         # ç­–ç•¥ï¼šlowest-latency / balanced / most-stable
    check-interval: 300              # å¥åº·æ£€æµ‹é—´éš”æ—¶é—´
    probe-type: ping                 # æ¢æµ‹æ–¹å¼ï¼šhttp / tcp / ping
    probe-url: 8.8.8.8
    probe-port: 80                   # HTTP æ¢æµ‹ç«¯å£
    max-loss: 30                     # ä¸¢åŒ…ç‡è¶…è¿‡30%è§†ä¸ºä¸å¯ç”¨
    max-jitter: 100                  # æŠ–åŠ¨å¤§äº100ms è§†ä¸ºä¸ç¨³å®š
    switch-threshold: 200            # å½“å‰èŠ‚ç‚¹å»¶è¿Ÿé«˜å‡ºå¹³å‡å€¼200msè‡ªåŠ¨åˆ‡æ¢
    weight:                          # æƒé‡è°ƒæ•´ï¼ˆéƒ¨åˆ†ç‰ˆæœ¬æ”¯æŒï¼‰
      äºšé©¬é€Š: 1.3
      ç‰›é€¼: 0.8
    enable: true                     # å¯ç”¨è¯¥æ™ºèƒ½ç»„

  # æ–°åŠ å¡ç»„
  - name: ç‹®åŸ-æ•…è½¬
    type: fallback
    interval: 180
    lazy: false
    proxies:
      - ç‹®åŸ-æ‰‹é€‰
      - ç‹®åŸ-æ™ºé€‰
  - name: ç‹®åŸ-æ‰‹é€‰
    type: select
    include-all: true
    filter: "(?=.*(å¹¿æ–°|æ–°åŠ å¡|SG|å¡|ç‹®åŸ|ğŸ‡¸ğŸ‡¬|Singapore)).*$"
  - name: ç‹®åŸ-æ™ºé€‰
    type: smart
    include-all: true
    policy-priority: ".*ç‰›é€¼.*:0.8"
    uselightgbm: true
    collectdata: true
    lightgbm-history-size: 150
    health-check:
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 120
      tolerance: 2
    strategy: sticky-sessions
    interval: 180
    filter: "(?=.*(å¹¿æ–°|æ–°åŠ å¡|SG|å¡|ç‹®åŸ|ğŸ‡¸ğŸ‡¬|Singapore)).*$"

  # æ—¥æœ¬ç»„
  - name: æ—¥éŸ©-æ•…è½¬
    type: fallback
    interval: 180
    lazy: false
    proxies:
      - æ—¥éŸ©-æ‰‹é€‰
      - æ—¥éŸ©-æ™ºé€‰
  - name: æ—¥éŸ©-æ‰‹é€‰
    type: select
    include-all: true
    filter: "(?=.*(éŸ©|KR|(?i)tokyo|(?i)Japan|å¹¿æ—¥|æ—¥æœ¬|JP|å·æ—¥|ä¸œäº¬|å¤§é˜ª|æ³‰æ—¥|åŸ¼ç‰|æ²ªæ—¥|æ·±æ—¥|ğŸ‡¯ğŸ‡µ)).*$"
  - name: æ—¥éŸ©-æ™ºé€‰
    type: smart
    include-all: true
    policy-priority: ".*ç‰›é€¼.*:0.8"
    uselightgbm: true
    collectdata: true
    lightgbm-history-size: 150
    health-check:
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 120
      tolerance: 2
    strategy: sticky-sessions
    interval: 180
    filter: "(?=.*(éŸ©|KR|(?i)tokyo|(?i)Japan|å¹¿æ—¥|æ—¥æœ¬|JP|å·æ—¥|ä¸œäº¬|å¤§é˜ª|æ³‰æ—¥|åŸ¼ç‰|æ²ªæ—¥|æ·±æ—¥|ğŸ‡¯ğŸ‡µ)).*$"

  # é¦™æ¸¯ç»„
  - name: é¦™æ¸¯-æ•…è½¬
    type: fallback
    interval: 180
    lazy: false
    proxies:
      - é¦™æ¸¯-æ‰‹é€‰
      - é¦™æ¸¯-æ™ºé€‰
  - name: é¦™æ¸¯-æ‰‹é€‰
    type: select
    include-all: true
    filter: "(?=.*(å¹¿æ¸¯|é¦™æ¸¯|HK|Hong Kong|ğŸ‡­ğŸ‡°|HongKong)).*$"
  - name: é¦™æ¸¯-æ™ºé€‰
    type: smart
    include-all: true
    policy-priority: ".*ç‰›é€¼.*:0.8"
    uselightgbm: true
    collectdata: true
    lightgbm-history-size: 150
    health-check:
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 120
      tolerance: 2
    strategy: sticky-sessions
    interval: 180
    filter: "(?=.*(å¹¿æ¸¯|é¦™æ¸¯|HK|Hong Kong|ğŸ‡­ğŸ‡°|HongKong)).*$"

  # å°æ¹¾ç»„
  - name: å°æ¹¾-æ•…è½¬
    type: fallback
    interval: 180
    lazy: false
    proxies:
      - å°æ¹¾-æ‰‹é€‰
      - å°æ¹¾-æ™ºé€‰
  - name: å°æ¹¾-æ‰‹é€‰
    type: select
    include-all: true
    filter: "(?=.*(å¹¿å°|å°æ¹¾|å°ç£|TW|Tai Wan|ğŸ‡¹ğŸ‡¼|ğŸ‡¨ğŸ‡³|TaiWan|Taiwan)).*$"
  - name: å°æ¹¾-æ™ºé€‰
    type: smart
    include-all: true
    policy-priority: ".*ç‰›é€¼.*:0.8"
    uselightgbm: true
    collectdata: true
    lightgbm-history-size: 150
    health-check:
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 120
      tolerance: 2
    strategy: sticky-sessions
    interval: 180
    filter: "(?=.*(å¹¿å°|å°æ¹¾|å°ç£|TW|Tai Wan|ğŸ‡¹ğŸ‡¼|ğŸ‡¨ğŸ‡³|TaiWan|Taiwan)).*$"

  # ç¾å›½ç»„
  - name: ç¾å›½-æ•…è½¬
    type: fallback
    interval: 180
    lazy: false
    proxies:
      - ç¾å›½-æ‰‹é€‰
      - ç¾å›½-æ™ºé€‰
  - name: ç¾å›½-æ‰‹é€‰
    type: select
    include-all: true
    filter: "(?=.*(å¹¿ç¾|ç¾|US|çº½çº¦|æ³¢ç‰¹å…°|è¾¾æ‹‰æ–¯|ä¿„å‹’|å‡¤å‡°åŸ|è´¹åˆ©è’™|æ‹‰æ–¯|æ´›æ‰|åœ£ä½•å¡|åœ£å…‹æ‹‰|è¥¿é›…|èŠåŠ |ğŸ‡ºğŸ‡¸|(?i)States|(?i)california|America)).*$"
  - name: ç¾å›½-æ™ºé€‰
    type: smart
    include-all: true
    policy-priority: ".*ç‰›é€¼.*:0.8"
    uselightgbm: true
    collectdata: true
    lightgbm-history-size: 150
    health-check:
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 120
      tolerance: 2
    strategy: sticky-sessions
    interval: 180
    filter: "(?=.*(å¹¿ç¾|ç¾|US|çº½çº¦|æ³¢ç‰¹å…°|è¾¾æ‹‰æ–¯|ä¿„å‹’|å‡¤å‡°åŸ|è´¹åˆ©è’™|æ‹‰æ–¯|æ´›æ‰|åœ£ä½•å¡|åœ£å…‹æ‹‰|è¥¿é›…|èŠåŠ |ğŸ‡ºğŸ‡¸|(?i)States|(?i)california|America)).*$"

# è§„åˆ™å’Œè§„åˆ™é›†ä¿æŒä¸å˜
rules:
  - RULE-SET,01.ä¼˜å…ˆä»£ç†,ä¼˜å…ˆä»£ç†
  - RULE-SET,apple_ip,DIRECT,no-resolve
  - RULE-SET,apple_domain,DIRECT
  - RULE-SET,Blizzard_domain,æ¸¸æˆä»£ç†
  - RULE-SET,01.æ¸¸æˆä»£ç†,æ¸¸æˆä»£ç†
  - RULE-SET,ai,ChatGPT
  - RULE-SET,google_ip,Google,no-resolve
  - RULE-SET,youtube_domain,YouTube
  - RULE-SET,google_domain,Google
  - RULE-SET,netflix_ip,Netflix,no-resolve
  - RULE-SET,netflix_domain,Netflix
  - RULE-SET,02.steamCN,SteamCN
  - RULE-SET,github_domain,GitHub
  - RULE-SET,microsoft_domain,Microsoft
  - RULE-SET,tiktok_domain,TikTok
  - RULE-SET,telegram_ip,Telegram,no-resolve
  - RULE-SET,telegram_domain,Telegram
  - RULE-SET,å¹¿å‘Š,æ‹’ç»
  - GEOIP,CN,DIRECT
  - MATCH,æ¼ç½‘ä¹‹é±¼

rule-anchor:
  ip: &ip {type: http, interval: 86400, behavior: ipcidr, format: mrs}
  domain: &domain {type: http, interval: 86400, behavior: domain, format: mrs}
  class: &class {type: http, interval: 86400, behavior: classical, format: text}

rule-providers:
  01.ä¼˜å…ˆä»£ç†: {type: file, interval: 86400, behavior: classical, format: yaml, path: "./ruleset/01.ä¼˜å…ˆä»£ç†.yaml"}
  01.æ¸¸æˆä»£ç†: {type: file, interval: 86400, behavior: classical, format: yaml, path: "./ruleset/01.æ¸¸æˆä»£ç†.yaml"}
  02.steamCN: {type: http, interval: 86400, behavior: domain, format: yaml, path: "./ruleset/02.steamCN.yaml", url:  "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/SteamCN/SteamCN.yaml"}
  Blizzard_domain: {<<: *class, url: "https://gh-proxy.com/raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Blizzard/Blizzard.list"}
  ai: {<<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/category-ai-!cn.mrs"}
  youtube_domain: {<<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/youtube.mrs"}
  google_domain: {<<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/google.mrs"}
  github_domain: {<<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/github.mrs"}
  telegram_domain: {<<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/telegram.mrs"}
  netflix_domain: {<<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/netflix.mrs"}
  microsoft_domain: {<<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/microsoft.mrs"}
  apple_domain: {<<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/apple-cn.mrs"}
  tiktok_domain: {<<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/tiktok.mrs"}
  google_ip: {<<: *ip, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/google.mrs"}
  telegram_ip: {<<: *ip, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/telegram.mrs"}
  netflix_ip: {<<: *ip, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/netflix.mrs"}
  apple_ip: {<<: *ip, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo-lite/geoip/apple.mrs"}
  å¹¿å‘Š: {type: http, interval: 86400, behavior: domain, format: yaml, path: "./ruleset/03.reject.yaml", url:  "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/reject.txt"}
